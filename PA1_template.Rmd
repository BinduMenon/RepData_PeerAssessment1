---
title: "Reproducible Research: Peer Assessment 1"
output: 
  html_document:
    keep_md: true
---

# Reproducible Research Assignment 1

## Synopsis

This assignment makes use of data from a personal activity monitoring device, such as Fitbit, Nike Fuelband or Jawbone up. The data is collected throughout the day, in 5 min inetrvals. For the assigment we will analyze 2 months of data from an anonymous individual collected during the months of October and November, 2012 and include the number of steps taken in 5 minute intervals each day.

## Data

*Datset:* [Activity Monitoring Data](https://d396qusza40orc.cloudfront.net/repdata%2Fdata%2Factivity.zip)  
*Variables:*  
    1. **steps:** Number of steps taking in a 5-minute interval (missing values are coded as NA)   
    2. **date:** The date on which the measurement was taken in YYYY-MM-DD format   
    3. **interval:** Identifier for the 5-minute interval in which measurement was taken  

### Loading Preprocessing the data into R
```{r, echo=TRUE}
# Set the working directory
setwd("D:/DataScience/Reproducible Research/Assignment 1")

# Read the activity data
activity_data <- read.csv('activity.csv')
head(activity_data)

#Remove NA from the activity file
clean_activity_data <- na.omit(activity_data)
head(clean_activity_data)
```

## Analysis of the data
### What is mean total number of steps taken per day?
Steps followed:  
 1. Calculate the total number of steps taken per day  
 2. Make a histogram of the total number of steps taken each day  
 3. Calculate and report the mean and median of the total number of steps taken per day
 
```{r, echo=TRUE}
# Aggregate steps in a day 
Agg_Step <- aggregate(steps ~ date, clean_activity_data, sum)

# Plot the histogram 
hist(Agg_Step$steps, main ="Total Number of steps taken per day", 
     xlab = "Steps/Day", col = "blue")

#Get the mean total number of steps per day
mean(Agg_Step$steps)

#Get the median total number of steps per day
median(Agg_Step$steps)
```


### What is the average daily activity pattern?
Steps followed: 
 1. Make a time series plot of the 5-minute interval and the average number of steps taken, averaged across all days 
 2. Find the row data which has the maximum average number of steps in an interval
 3. Get the interval for the maximun number of steps

```{r, echo=TRUE}
# Aggregate steps in a 5 min intervals 
Agg_interval <- aggregate(steps ~ interval, clean_activity_data, mean)

# Plot the times series graph 
plot(Agg_interval$interval, Agg_interval$steps, type = 'l', col = 'green',
     main = "Average Number of steps across all days",
     xlab = "5 min intervals",
     ylab = "Avg number of steps")

#Row data which has the maximum average number of steps in an interval
max_steps <- which.max(Agg_interval$steps)

#Get the interval for the maximun number of steps
Agg_interval[max_steps, ]

```
### Imputing missing values
Steps followed: 
 1. Calculate and report the total number of missing values in the dataset
 2. Devise a strategy for filling in all of the missing values in the dataset. 
 3. Create a new dataset that is equal to the original dataset but with the missing data filled in.
 4. Make a histogram of the total number of steps taken each day and Calculate and report the mean and median total number of steps taken per day.

```{r, echo=TRUE}
# Get the total number of NA in the dataset
NA_rows <- sum(is.na(activity_data))

#Replace NA by the mean for that 5 min interval
rep_na <- aggregate(steps ~ interval, clean_activity_data, mean)

#Perform imputation using for loop using the value from rep_na
for (i in 1:nrow(activity_data)) {
      if(is.na(activity_data$steps[i])){
            new_interval <- activity_data$interval[i]
            row <- which(rep_na$interval == new_interval)
            new_steps <- rep_na$steps[row]
            activity_data$steps[i] <- new_steps
      }
}

#new aggregate 
activity_data_imputed <- aggregate(steps ~ date, activity_data, sum)

#new histogram
hist(activity_data_imputed$steps, 
     main ="Total Number of steps taken per day (Imputed Data", 
     xlab = "Steps/Day", col = "red")

```
## Are there differences in activity patterns between weekdays and weekends?
